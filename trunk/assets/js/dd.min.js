jQuery(document).ready((function(e){var t=document.getElementsByName("shipping_method[0]");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;null===o&&void 0!==t[0]?o=t[0].value:null===o&&(o="");var d=[];for(const[e,t]of Object.entries(bkf_dd_options.datesListFull))t.pass?(void 0!==t.mr&&t.mr.forEach((function(t,i,n){t==o&&(d[e]=[!1,"unavailable",bkf_dd_options.mrText])})),void 0!==t.msl&&t.msl.forEach((function(t,i,n){timeNow=new Date,timeThen=new Date(t[2]),t==o&&timeNow>=timeThen&&(d[e]=[!1,"unavailable",bkf_dd_options.sdcMethod])}))):d[e]=t.outcome;jQuery("#delivery_date").attr("readOnly","true"),jQuery(".delivery_date").datepicker({minDate:0,maxDate:bkf_dd_options.maxDate,dateFormat:"DD, d MM yy",hideIfNoPrevNext:!0,firstDay:1,constrainInput:!0,beforeShowDay:function(e){var t=e.getDate(),o=e.getMonth()+1,i=e.getFullYear(),n=t+"."+o+"."+i;void 0!==d[n]?currentResult=d[n]:currentResult=[!0];return currentResult},onUpdateDatepicker:function(e){dates=jQuery(".ui-datepicker-calendar td"),dates.each((function(e){jQuery(this).css("pointer-events","auto")}))},showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0})})),jQuery(document.body).on("change","input.shipping_method",(function(e){var t=document.getElementsByName("shipping_method[0]");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;null===o&&void 0!==t[0]?o=t[0].value:null===o&&(o="");var d=[];for(const[e,t]of Object.entries(bkf_dd_options.datesListFull))t.pass?(void 0!==t.mr&&t.mr.forEach((function(t,i,n){t==o&&(d[e]=[!1,"unavailable",bkf_dd_options.mrText])})),void 0!==t.msl&&t.msl.forEach((function(t,i,n){timeNow=new Date,timeThen=new Date(t[2]),t==o&&timeNow>=timeThen&&(d[e]=[!1,"unavailable",bkf_dd_options.sdcMethod])}))):d[e]=t.outcome;jQuery(".delivery_date").datepicker("option",{beforeShowDay:function(e){var t=e.getDate(),o=e.getMonth()+1,i=e.getFullYear(),n=t+"."+o+"."+i;void 0!==d[n]?currentResult=d[n]:currentResult=[!0];return currentResult}})})),jQuery(document).on("change","input.shipping_method, input.delivery_date",(function(e){const t=document.querySelector("#delivery_timeslot"),o=document.querySelector("#delivery_date").value;if(jQuery(t).empty(e),o.length&&bkf_dd_options_ts.length)bkf_dd_options.debug&&console.debug("change input: datefield.length && bkf_dd_options_ts.length"),jQuery.ajax(bkf_dd_options.ajax_url,{async:!1,data:{action:"bkf_retrieve_session_ts"},method:"POST",success:function(e){currentTs=JSON.parse(e)}}),bkf_dd_options_ts.forEach((function(e){const t=document.querySelector("#delivery_timeslot_field"),o=document.querySelector("#delivery_timeslot");var d,n=document.getElementsByName("shipping_method[0]");bkf_dd_options.debug&&(console.debug(n),console.debug(n[0]),console.debug(n[0].value));for(i=0;i<n.length;i++)n[i].checked&&(d=n[i].value);void 0===d&&void 0!==n[0]?d=n[0].value:void 0===d&&void 0!==n?d=n.value:void 0===d&&(d="");var r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],u=document.querySelector("#delivery_date").value,l=Date.parse(u),s=new Date(l),a=r[s.getDay()];if(e.day==a&&e.method==d)if(currentTs==e.slot){let t=new Option(e.text,e.slot,!0,!0);o.add(t,void 0)}else{let t=new Option(e.text,e.slot,!1);o.add(t,void 0)}if(document.querySelector("#delivery_timeslot").options.length){const e=document.querySelector("#delivery_timeslot_field");jQuery(e).removeClass("bkf-hidden"),document.querySelector("#delivery_timeslot").setAttribute("required","")}else jQuery(t).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}));else{bkf_dd_options.debug&&console.debug("change input: !datefield.length || !bkf_dd_options_ts.length");const e=document.querySelector("#delivery_timeslot_field");jQuery(e).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}})),jQuery(document).ready((function(e){const t=document.querySelector("#delivery_timeslot"),o=document.querySelector("#delivery_date").value;if(jQuery(t).empty(e),o.length&&bkf_dd_options_ts.length)bkf_dd_options.debug&&console.debug("document ready: datefield.length && bkf_dd_options_ts.length"),jQuery.ajax(bkf_dd_options.ajax_url,{async:!1,data:{action:"bkf_retrieve_session_ts"},method:"POST",success:function(e){currentTs=JSON.parse(e)}}),bkf_dd_options_ts.forEach((function(e){const t=document.querySelector("#delivery_timeslot_field"),o=document.querySelector("#delivery_timeslot");var d,n=document.getElementsByName("shipping_method[0]");bkf_dd_options.debug&&(console.debug(n),console.debug(n[0]),console.debug(n[0].value));for(i=0;i<n.length;i++)n[i].checked&&(d=n[i].value);void 0===d&&void 0!==n[0]?d=n[0].value:void 0===d&&void 0!==n?d=n.value:void 0===d&&(d="");var r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],u=document.querySelector("#delivery_date").value,l=Date.parse(u),s=new Date(l),a=r[s.getDay()];if(e.day==a&&e.method==d)if(currentTs==e.slot){let t=new Option(e.text,e.slot,!0,!0);o.add(t,void 0)}else{let t=new Option(e.text,e.slot,!1);o.add(t,void 0)}if(document.querySelector("#delivery_timeslot").options.length){const e=document.querySelector("#delivery_timeslot_field");jQuery(e).removeClass("bkf-hidden"),document.querySelector("#delivery_timeslot").setAttribute("required","")}else jQuery(t).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}));else{bkf_dd_options.debug&&console.debug("document ready: !datefield.length || !bkf_dd_options_ts.length");const e=document.querySelector("#delivery_timeslot_field");jQuery(e).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}})),bkf_dd_options.pickup&&jQuery(document).ready((function(e){jQuery("input[name='ship_type']").change((function(e){jQuery("body").trigger("update_checkout");var t=document.getElementsByName("ship_type");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;bkf_dd_options.debug&&console.debug("ship_type changed to: "+o),jQuery.ajax({type:"POST",url:bkf_dd_options.ajax_url,data:{action:"bkf_checkout_get_ajax_data",ship_type:o},success:function(e){jQuery("body").trigger("update_checkout")},error:function(e){console.error(e)}}),"delivery"==o?jQuery("#customer_details .woocommerce-shipping-fields").fadeIn():"pickup"==o&&jQuery("#customer_details .woocommerce-shipping-fields").fadeOut()}))}));