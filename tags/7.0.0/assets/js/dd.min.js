jQuery(document).ready((function(e){var t=document.getElementsByName("shipping_method[0]");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;null===o&&void 0!==t[0]?o=t[0].value:null===o&&(o="");var d=[];for(const[e,t]of Object.entries(bkf_dd_options.datesListFull))t.pass?(void 0!==t.mr&&t.mr.forEach((function(t,i,r){t==o&&(d[e]=[!1,"unavailable",bkf_dd_options.mrText])})),void 0!==t.msl&&t.msl.forEach((function(t,i,r){timeNow=new Date,timeThen=new Date(t[2]),t==o&&timeNow>=timeThen&&(d[e]=[!1,"unavailable",bkf_dd_options.sdcMethod])}))):d[e]=t.outcome;jQuery("#delivery_date").attr("readOnly","true"),jQuery(".delivery_date").datepicker({minDate:0,maxDate:bkf_dd_options.maxDate,dateFormat:"DD, d MM yy",hideIfNoPrevNext:!0,firstDay:1,constrainInput:!0,beforeShowDay:function(e){var t=e.getDate(),o=e.getMonth()+1,i=e.getFullYear(),r=t+"."+o+"."+i;void 0!==d[r]?currentResult=d[r]:currentResult=[!0];return currentResult},onUpdateDatepicker:function(e){dates=jQuery(".ui-datepicker-calendar td"),dates.each((function(e){jQuery(this).css("pointer-events","auto")}))},showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0})})),jQuery(document.body).on("change","input.shipping_method",(function(e){var t=document.getElementsByName("shipping_method[0]");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;null===o&&void 0!==t[0]?o=t[0].value:null===o&&(o="");var d=[];for(const[e,t]of Object.entries(bkf_dd_options.datesListFull))t.pass?(void 0!==t.mr&&t.mr.forEach((function(t,i,r){t==o&&(d[e]=[!1,"unavailable",bkf_dd_options.mrText])})),void 0!==t.msl&&t.msl.forEach((function(t,i,r){timeNow=new Date,timeThen=new Date(t[2]),t==o&&timeNow>=timeThen&&(d[e]=[!1,"unavailable",bkf_dd_options.sdcMethod])}))):d[e]=t.outcome;jQuery(".delivery_date").datepicker("option",{beforeShowDay:function(e){var t=e.getDate(),o=e.getMonth()+1,i=e.getFullYear(),r=t+"."+o+"."+i;void 0!==d[r]?currentResult=d[r]:currentResult=[!0];return currentResult}})})),jQuery(document).on("change","input.shipping_method, input.delivery_date",(function(e){const t=document.querySelector("#delivery_timeslot"),o=document.querySelector("#delivery_date").value;if(jQuery(t).empty(e),o.length&&bkf_dd_options_ts.length)bkf_dd_options.debug&&console.debug("change input: datefield.length && bkf_dd_options_ts.length"),jQuery.ajax(bkf_dd_options.ajax_url,{async:!1,data:{action:"bkf_retrieve_session_ts"},method:"POST",success:function(e){currentTs=JSON.parse(e)}}),bkf_dd_options_ts.forEach((function(e){const t=document.querySelector("#delivery_timeslot_field"),o=document.querySelector("#delivery_timeslot");var d,r=document.getElementsByName("shipping_method[0]");bkf_dd_options.debug&&(console.debug(r),console.debug(r[0]),console.debug(r[0].value));for(i=0;i<r.length;i++)r[i].checked&&(d=r[i].value);void 0===d&&void 0!==r[0]?d=r[0].value:void 0===d&&void 0!==r?d=r.value:void 0===d&&(d="");var n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],u=document.querySelector("#delivery_date").value,a=Date.parse(u),s=new Date(a),l=n[s.getDay()];if(e.day==l&&e.method==d)if(currentTs==e.slot){let t=new Option(e.text,e.slot,!0,!0);o.add(t,void 0)}else{let t=new Option(e.text,e.slot,!1);o.add(t,void 0)}if(document.querySelector("#delivery_timeslot").options.length){const e=document.querySelector("#delivery_timeslot_field");jQuery(e).removeClass("bkf-hidden"),document.querySelector("#delivery_timeslot").setAttribute("required","")}else jQuery(t).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}));else{bkf_dd_options.debug&&console.debug("change input: !datefield.length || !bkf_dd_options_ts.length");const e=document.querySelector("#delivery_timeslot_field");jQuery(e).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}})),jQuery(document).ready((function(e){const t=document.querySelector("#delivery_timeslot"),o=document.querySelector("#delivery_date").value;if(jQuery(t).empty(e),o.length&&bkf_dd_options_ts.length)bkf_dd_options.debug&&console.debug("document ready: datefield.length && bkf_dd_options_ts.length"),jQuery.ajax(bkf_dd_options.ajax_url,{async:!1,data:{action:"bkf_retrieve_session_ts"},method:"POST",success:function(e){currentTs=JSON.parse(e)}}),bkf_dd_options_ts.forEach((function(e){const t=document.querySelector("#delivery_timeslot_field"),o=document.querySelector("#delivery_timeslot");var d,r=document.getElementsByName("shipping_method[0]");bkf_dd_options.debug&&(console.debug(r),console.debug(r[0]),console.debug(r[0].value));for(i=0;i<r.length;i++)r[i].checked&&(d=r[i].value);void 0===d&&void 0!==r[0]?d=r[0].value:void 0===d&&void 0!==r?d=r.value:void 0===d&&(d="");var n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],u=document.querySelector("#delivery_date").value,a=Date.parse(u),s=new Date(a),l=n[s.getDay()];if(e.day==l&&e.method==d)if(currentTs==e.slot){let t=new Option(e.text,e.slot,!0,!0);o.add(t,void 0)}else{let t=new Option(e.text,e.slot,!1);o.add(t,void 0)}if(document.querySelector("#delivery_timeslot").options.length){const e=document.querySelector("#delivery_timeslot_field");jQuery(e).removeClass("bkf-hidden"),document.querySelector("#delivery_timeslot").setAttribute("required","")}else jQuery(t).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}));else{bkf_dd_options.debug&&console.debug("document ready: !datefield.length || !bkf_dd_options_ts.length");const e=document.querySelector("#delivery_timeslot_field");jQuery(e).addClass("bkf-hidden"),document.querySelector("#delivery_timeslot").removeAttribute("required")}})),jQuery(document).ready((function(e){jQuery("body").on("blur change","#delivery_date",(function(){const e=jQuery(this).closest(".form-row");/[a-zA-Z]{6,9}\,\ \d{1,2}\ [a-zA-Z]{3,9}\ \d{4}/.test(jQuery(this).val())?e.addClass("woocommerce-validated"):(e.addClass("woocommerce-invalid"),e.removeClass("woocommerce-validated"))})),jQuery("body").on("blur change","#delivery_date, #delivery_timeslot",(function(){const e=jQuery("#delivery_timeslot").closest(".form-row"),t=document.getElementById("delivery_timeslot");t.hasAttribute("required")&&""==t.value?(e.addClass("woocommerce-invalid"),e.removeClass("woocommerce-validated")):e.addClass("woocommerce-validated")})),jQuery("form.checkout").on("change","#delivery_date, #delivery_timeslot",(function(){var e=jQuery("#delivery_date").val(),t=jQuery("#delivery_timeslot").val();jQuery.ajax({type:"POST",url:wc_checkout_params.ajax_url,data:{action:"bkf_checkout_get_ajax_data",delivery_date:e,delivery_timeslot:t},success:function(e){jQuery("body").trigger("update_checkout")},error:function(e){console.log(e)}})})),jQuery("form.checkout").on("change","#shipping_notes, #card_message",(function(){var e=jQuery("#shipping_notes").val(),t=jQuery("#card_message").val();jQuery.ajax({type:"POST",url:wc_checkout_params.ajax_url,data:{action:"bkf_checkout_get_ajax_data",shipping_notes:e,card_message:t},success:function(e){jQuery("body").trigger("update_checkout")},error:function(e){console.log(e)}})}))})),bkf_dd_options.pickup&&jQuery(document).ready((function(e){jQuery("form.checkout").on("change","input[name='ship_type']",(function(e){var t=document.getElementsByName("ship_type");for(i=0;i<t.length;i++)if(t[i].checked)var o=t[i].value;bkf_dd_options.debug&&console.debug("ship_type changed to: "+o),jQuery.ajax({type:"POST",url:bkf_dd_options.ajax_url,data:{action:"bkf_checkout_get_ajax_data",ship_type:o},success:function(e){jQuery("body").trigger("update_checkout"),bkf_dd_options.debug&&console.debug(e)},error:function(e){console.error(e)}}),"delivery"==o?jQuery("#customer_details .woocommerce-shipping-fields").fadeIn():"pickup"==o&&jQuery("#customer_details .woocommerce-shipping-fields").fadeOut()}))}));